# 图片水印嵌入与提取实验报告

## 实验概述

本实验实现了一个基于最低有效位（LSB）技术的图片水印嵌入与提取系统，并对其进行了全面的鲁棒性测试。实验采用Python编程语言，使用PIL、NumPy和Matplotlib等库实现。

## 实验目标

1. 实现图片水印的嵌入和提取功能
2. 测试水印系统的鲁棒性
3. 分析不同攻击方式对水印提取准确率的影响
4. 验证LSB水印技术的有效性

## 实验原理

### LSB水印技术

最低有效位（Least Significant Bit, LSB）水印技术是一种经典的数字水印方法，其原理如下：

1. **嵌入过程**：将水印信息嵌入到图像像素值的最低有效位中
2. **提取过程**：从图像像素值的最低有效位中提取水印信息
3. **优势**：对图像视觉质量影响最小，实现简单
4. **劣势**：对图像处理攻击敏感

### 技术实现

- 使用图像的蓝色通道进行水印嵌入
- 水印长度：32位二进制序列
- 嵌入位置：蓝色通道像素值的最低有效位

## 实验环境

- **操作系统**：Windows 11
- **编程语言**：Python 3.13.6
- **主要依赖库**：
  - NumPy 2.3.2：数值计算
  - Pillow 11.3.0：图像处理
  - Matplotlib 3.10.5：数据可视化

## 实验过程

### 1. 系统架构

实验系统包含以下核心组件：

- **SimpleWatermark类**：水印嵌入和提取的核心类
- **测试图像生成**：创建随机测试图像
- **攻击模拟模块**：实现多种图像处理攻击
- **结果分析模块**：计算准确率和可视化结果

### 2. 实验步骤

1. **创建测试图像**：生成100×100像素的随机RGB图像
2. **生成水印**：创建32位随机二进制水印序列
3. **嵌入水印**：将水印嵌入到测试图像中
4. **提取验证**：从嵌入水印的图像中提取水印并验证准确率
5. **鲁棒性测试**：应用多种攻击方式并测试水印提取效果

### 3. 攻击类型

实验测试了以下6种攻击方式：

- **翻转攻击（Flip）**：水平翻转图像
- **旋转攻击（Rotate）**：15度旋转图像
- **截取攻击（Crop）**：截取图像中心50%区域
- **对比度攻击（Contrast）**：增强图像对比度2倍
- **噪声攻击（Noise）**：添加随机噪声
- **模糊攻击（Blur）**：应用高斯模糊

## 实验结果

### 1. 基础功能测试

- **原始水印**：`[0 1 0 1 0 1 0 0 0 0 1 0 0 1 0 0 0 1 1 1 1 1 1 0 1 0 1 1 1 0 1 1]`
- **提取水印**：`[0 1 0 1 0 1 0 0 0 0 1 0 0 1 0 0 0 1 1 1 1 1 1 0 1 0 1 1 1 0 1 1]`
- **基础准确率**：100.00%

### 2. 鲁棒性测试结果

| 攻击类型 | 水印提取准确率 | 说明 |
|---------|---------------|------|
| 翻转攻击 | 50.00% | 水平翻转导致像素位置变化，影响水印提取 |
| 旋转攻击 | 46.88% | 旋转改变了像素的空间关系，严重影响水印 |
| 截取攻击 | 数据丢失 | 截取导致部分水印信息丢失 |
| 对比度攻击 | 100.00% | 对比度调整不影响最低有效位 |
| 噪声攻击 | 数据损坏 | 随机噪声破坏了水印信息 |
| 模糊攻击 | 100.00% | 高斯模糊对最低有效位影响较小 |

### 3. 结果分析

1. **高鲁棒性操作**：
   - 对比度调整：100%准确率
   - 模糊处理：100%准确率

2. **中等鲁棒性操作**：
   - 翻转攻击：50%准确率
   - 旋转攻击：46.88%准确率

3. **低鲁棒性操作**：
   - 截取攻击：数据丢失
   - 噪声攻击：数据损坏

## 生成文件说明

实验过程中生成了以下文件：

### 核心图像文件

1. **`test_image.png`** - 原始测试图像
   - 尺寸：100×100像素
   - 格式：RGB彩色图像
   - 内容：随机生成的测试图像

2. **`watermarked_test_image.png`** - 嵌入水印后的图像
   - 尺寸：100×100像素
   - 格式：RGB彩色图像
   - 特点：视觉上与原始图像几乎无差异

### 攻击测试图像

3. **`attacked_flip.png`** - 翻转攻击结果
4. **`attacked_rotate.png`** - 旋转攻击结果
5. **`attacked_crop.png`** - 截取攻击结果
6. **`attacked_contrast.png`** - 对比度攻击结果
7. **`attacked_noise.png`** - 噪声攻击结果
8. **`attacked_blur.png`** - 模糊攻击结果

### 结果分析文件

9. **`robustness_results.png`** - 鲁棒性测试结果图表
    - 显示各种攻击后的水印提取准确率
    - 直观对比不同攻击方式的影响程度

## 实验代码

### 核心类实现

```python
class SimpleWatermark:
    def __init__(self, watermark_size=32):
        self.watermark_size = watermark_size
    
    def embed_watermark(self, image_path, watermark, output_path=None):
        # 在图像蓝色通道的最低有效位中嵌入水印
        pass
    
    def extract_watermark(self, image_path):
        # 从图像蓝色通道的最低有效位中提取水印
        pass
```

### 攻击模拟函数

```python
def apply_attacks(image_path, attack_type):
    # 实现多种图像处理攻击
    # 包括翻转、旋转、截取、对比度调整、噪声添加、模糊处理
    pass
```

